- protocol: mcintosh_v3
  name: McIntosh v3 API
  description: Based on MX160 Serial Control Manual v3

  # default baud rate (see series yaml for overrides per model)
  connection:
    rs232:
      baud: 115200
      data: 8
      parity: N
      stop: 1

  format:
    command:
      format: "{cmd}{eol}"
      eol: ""
      separator: '#'

    message:
      format: "{msg}{eol}"
      eol: "\r"
      separator: '#'

  api_settings:
    min_time_between_commands: 0.4

  api_vars:
    zone:
      pattern: '[1-8]'
      type: int
      min: 1
      max: 8
    power:
      pattern: '[01]'
      type: int
      min: 0
      max: 1
    mute:
      pattern: '[01]'
      type: int
      min: 0
      max: 1
    volume:
      type: int
      min: 0
      max: 38
    treble:
      type: int
      min: 0
      max: 14
    bass:
      type: int
      min: 0
      max: 14
    balance:
      type: int
      min: 0
      max: 63
    source:
      type: int
      min: 1
      max: 8
    verbosity_level:
      type: int
      min: 1
      max: 3
      values:
        1: Minimal
        2: Normal
        3: All
    display_brightness:
      type: int
      min: 0
      max: 3
      values: 
        0: Full (100%)
        1: Bright (75%)
        2: Low (50%)
        3: Dark (25%)
    interface:
      type: string
      values:
        IP: IP
        SERIAL: Serial
    lipsync:
      type: int

  api_v2:
    verbosity:
      api:
        set:
          cmd: '!VERB({verbosity_level})'
        minimal:
          cmd: '!VERB(1)'
        normal:
          cmd: '!VERB(2)'
        all:
          cmd: '!VERB(3)'

    audio_mode:
      description: Audio processing mode control
      api:
        down:
          cmd: '!AUDMODE-'
          description: Audio processing mode down button
        'up':
          cmd: '!AUDMODE+'
          description: Audio processing mode up button
        query:
          cmd: '!AUDMODE?'
          description: Request audio processing mode
        modes:
          cmd: '!AUDMODEL?'
          description: Get list of audio processing modes

  audio_type:
    description: Input audio type
    api:
      query:
        cmd: '!AUDTYPE?'
        description: Return string of the input audio type.

  buttons:
    description: Remote button presses
    api:
      back:
        cmd: '!BACK'
        description: Back button
      down:
        cmd: '!DIRD'
        description: Direction Down button
      left:
        cmd: '!DIRL'
        description: Direction Left button
      right:
        cmd: '!DIRR'
        description: Direction Right button
      up:
        cmd: '!DIRU'
        description: Direction Up button
      enter:
        cmd: '!ENTER'
        description: Enter button
      exit:
        cmd: '!EXIT'
        description: Exit button
      info:
        cmd: '!INFO'
        description: Info button
      menu:
        cmd: '!MENU'
        description: Menu Button
      setup:
        cmd: '!SETUP'
        description: Setup button

    device:
      api:
        name:
          description: Returns the name of the device. !DEVICE(MX160) for MX160.
          cmd: '!DEVICE?'
          msg: '!DEVICE({name})'

    display_brightness:
      #aliases: ['display']
      description: VFD display brightness (0 – 3; 0=100%, 1=75%, 2=50%, 3=25%)
      api:
        down:
          description: Reduce brightness of the VFD display
          cmd: '!DIM-'
        up:
          description: Increase the brightness of the VFD display
          cmd: '!DIM+'
        query:
          description: Request brightness of the VFD display. (0 – 3; 0=100%, 1=75%, 2=50%, 3=25%)
          cmd: '!DIM?'
        set:
          description: Set display brightness level
          cmd: '!DIM({display_brightness})'
        full:
          description: Set display brightness Full (100%)
          cmd: '!DIM(0)'
        bright:
          description: Set display brightness Bright (75%)
          cmd: '!DIM(1)'
        low:
          description: Set display brightness Low (50%)
          cmd: '!DIM(2)'
        dark:
          description: Set display brightness Dark (25%)
          cmd: '!DIM(3)'
 
    interface:
      description: Active interface for this session (IP or SERIAL)
      query:
        description: Returns the active interface for this section
        cmd: '!INTERFACE?'
        msg: '!INTERFACE({interface})'

    lipsync:
      description: Lipsync
      api:
      set:
        description: Set the lipsync value
        cmd: '!LIPSYNC({lipsync})'  
      query:
        description: Query the lipsync value
        cmd: '!LIPSYNC?'
        msg: '!LIPSYNC({lipsync})'
      range:
        cmd: '!LIPSYNCRANGE?'
        description: Query the lipsync value range
      down:
        description: Reduce lipsync value
        cmd: '!LIPSYNC-'
      up:
        description: Increase lipsync value
        cmd: '!LIPSYNC-'
